var tape=require("tape"),jsdom=require("../jsdom"),d3=require("../../");tape("selection.enter() returns an empty selection before a data-join",function(e){var t=jsdom("<h1>hello</h1>").body,n=d3.select(t);e.deepEqual(n.enter(),{_groups:[[]],_parents:[null]}),e.end()}),tape("selection.enter() contains EnterNodes",function(e){var t=jsdom().body,n=d3.select(t).selectAll("div").data([1,2,3]);e.equal(n.enter().node().constructor.name,"EnterNode"),e.end()}),tape("selection.enter() shares the update selection’s parents",function(e){var t=jsdom("<h1>hello</h1>").body,n=d3.select(t);e.equal(n.enter()._parents,n._parents),e.end()}),tape("selection.enter() returns the same selection each time",function(e){var t=jsdom("<h1>hello</h1>").body,n=d3.select(t);e.deepEqual(n.enter(),n.enter()),e.end()}),tape("selection.enter() contains unbound data after a data-join",function(e){var t=jsdom("<div id='one'></div><div id='two'></div>").body,n=(t.querySelector("#one"),t.querySelector("#two"),d3.select(t).selectAll("div").data(["foo","bar","baz"]));e.deepEqual(n.enter(),{_groups:[[,,{__data__:"baz",_next:null,_parent:t,namespaceURI:"http://www.w3.org/1999/xhtml",ownerDocument:t.ownerDocument}]],_parents:[t]}),e.end()}),tape("selection.enter() uses the order of the data",function(e){var t=jsdom("<div id='one'></div><div id='two'></div><div id='three'></div>").body,n=(t.querySelector("#one"),t.querySelector("#two"),t.querySelector("#three")),r=d3.select(t).selectAll("div").data(["one","four","three","five"],function(e){return e||this.id});e.deepEqual(r.enter(),{_groups:[[,{__data__:"four",_next:n,_parent:t,namespaceURI:"http://www.w3.org/1999/xhtml",ownerDocument:t.ownerDocument},,{__data__:"five",_next:null,_parent:t,namespaceURI:"http://www.w3.org/1999/xhtml",ownerDocument:t.ownerDocument}]],_parents:[t]}),e.end()}),tape("enter.append(…) inherits the namespaceURI from the parent",function(e){var t=d3.select(jsdom().body),n=t.append("svg"),r=n.selectAll("g").data(["foo"]).enter().append("g");e.equal(t.node().namespaceURI,"http://www.w3.org/1999/xhtml"),e.equal(n.node().namespaceURI,"http://www.w3.org/2000/svg"),e.equal(r.node().namespaceURI,"http://www.w3.org/2000/svg"),e.end()}),tape("enter.append(…) does not override an explicit namespace",function(e){var t=d3.select(jsdom().body),n=t.append("svg"),r=n.selectAll("g").data(["foo"]).enter().append("xhtml:g");e.equal(t.node().namespaceURI,"http://www.w3.org/1999/xhtml"),e.equal(n.node().namespaceURI,"http://www.w3.org/2000/svg"),e.equal(r.node().namespaceURI,"http://www.w3.org/1999/xhtml"),e.end()}),tape("enter.append(…) inserts entering nodes before the next node in the update selection",function(e){var t=jsdom(),n=function(e){return e},r=d3.select(t.body).selectAll("p");r=r.data([1,3],n),r=r.enter().append("p").text(n).merge(r),r=r.data([0,1,2,3,4],n),r=r.enter().append("p").text(n).merge(r),e.equal(t.body.innerHTML,"<p>0</p><p>1</p><p>2</p><p>3</p><p>4</p>"),e.end()}),tape("enter.insert(…, before) inserts entering nodes before the sibling matching the specified selector",function(e){var t=jsdom("<hr>"),n=function(e){return e},r=d3.select(t.body).selectAll("p");r=r.data([1,3],n),r=r.enter().insert("p","hr").text(n).merge(r),r=r.data([0,1,2,3,4],n),r=r.enter().insert("p","hr").text(n).merge(r),e.equal(t.body.innerHTML,"<p>1</p><p>3</p><p>0</p><p>2</p><p>4</p><hr>"),e.end()}),tape("enter.insert(…, null) inserts entering nodes after the last child",function(e){var t=jsdom(),n=function(e){return e},r=d3.select(t.body).selectAll("p");r=r.data([1,3],n),r=r.enter().insert("p",null).text(n).merge(r),r=r.data([0,1,2,3,4],n),r=r.enter().insert("p",null).text(n).merge(r),e.equal(t.body.innerHTML,"<p>1</p><p>3</p><p>0</p><p>2</p><p>4</p>"),e.end()});