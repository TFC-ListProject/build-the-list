"use strict";function createDonutChart(e,t){var n=getLegendChart(e,t),r=donut(),o=d3Selection.select(".js-donut-chart-container"),a=o.node()?o.node().getBoundingClientRect().width:!1;a&&(d3Selection.select("#button").on("click",function(){r.exportChart()}),r.width(a).height(a).externalRadius(a/2.5).internalRadius(a/5).on("customMouseOver",function(e){n.highlight(e.data.id)}).on("customMouseOut",function(){n.clearHighlight()}),t&&r.colorSchema(t),o.datum(e).call(r),d3Selection.select("#button").on("click",function(){r.exportChart("donut.png","Britecharts Donut Chart")}))}function getLegendChart(e,t){var n=legend(),r=d3Selection.select(".js-legend-chart-container"),o=r.node()?r.node().getBoundingClientRect().width:!1;return o?(d3Selection.select(".js-legend-chart-container .britechart-legend").remove(),n.width(.8*o).height(200),t&&n.colorSchema(t),r.datum(e).call(n),n):void 0}function getInlineLegendChart(e,t){var n=legend(),r=d3Selection.select(".js-inline-legend-chart-container"),o=r.node()?r.node().getBoundingClientRect().width:!1;return o?(d3Selection.select(".js-inline-legend-chart-container .britechart-legend").remove(),n.horizontal(!0).width(.6*o).markerSize(8).height(40),t&&n.colorSchema(t),r.datum(e).call(n),n):void 0}function createSmallDonutChart(){var e=donut(),t=d3Selection.select(".js-small-donut-chart-container"),n=t.node()?t.node().getBoundingClientRect().width:!1,r=(new dataBuilder.DonutDataBuilder).withThreeCategories().build(),o=getInlineLegendChart(r);n&&(e.width(n).height(n/1.8).externalRadius(n/5).internalRadius(n/10).on("customMouseOver",function(e){o.highlight(e.data.id)}).on("customMouseOut",function(){o.clearHighlight()}),t.datum(r).call(e))}var d3Selection=require("d3-selection"),PubSub=require("pubsub-js"),donut=require("./../src/charts/donut"),legend=require("./../src/charts/legend"),dataBuilder=require("./../test/fixtures/donutChartDataBuilder"),colorSelectorHelper=require("./helpers/colorSelector"),dataset=(new dataBuilder.DonutDataBuilder).withFivePlusOther().build(),legendChart;if(d3Selection.select(".js-donut-chart-container").node()){createDonutChart(dataset),createSmallDonutChart();var redrawCharts=function(){d3Selection.selectAll(".donut-chart").remove(),createDonutChart(dataset),createSmallDonutChart()};PubSub.subscribe("resize",redrawCharts),colorSelectorHelper.createColorSelector(".js-color-selector-container",".donut-chart",createDonutChart.bind(null,dataset))}